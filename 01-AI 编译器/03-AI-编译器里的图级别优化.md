# AI 编译器里的图级别优化

## 推理引擎架构
- Parser：将代码解析成计算图
- Graph：计算图的表示
- Runtime：运行时图的表示
- Backend：图的后端，将计算图编译成目标代码

## 图优化定义
将一种计算图结构，在算术结果不改变的情况下，基于一系列预先写好的模板，对计算图进行相应的图替换操作。
## 图优化解决的问题
- 结构冗余
- 读写冗余

## 图优化方法
- 常量折叠
- 冗余节点消除
- 计算图替换
- 算子融合
- 数据布局转换
- 自动图优化搜索

## 图优化流程
- 1.启动时会构建一个图优化Pass名字和功能代码映射的表。
- 2.计算图构建完成后在下沉到运行时图之前，会将仓库中的图优化Pass中执行一遍
- 3.如果满足特定的图转换机制会跳转到对应的代码中完成图替换
- 4.重复步骤3直到仓库中的图优化Pass没有可以执行的Pass
- 5.输出得到新的计算图并下沉到运行时图
